import{_ as V}from"./preload-helper-ckwbz45p.js";import{r as d,w as A,x as H,a as U,y as J,z as T,L as q}from"./components-CZEx2DQX.js";import{j as C}from"./jsx-runtime-0DLF9kdB.js";function S(e){if(!e){const t=`flattenConnection(): needs a 'connection' to flatten, but received '${e??""}' instead.`;return console.error(t+" Returning an empty array"),[]}return"nodes"in e?e.nodes:"edges"in e&&Array.isArray(e.edges)?e.edges.map(t=>{if(!(t!=null&&t.node))throw new Error("flattenConnection(): Connection edges must contain nodes");return t.node}):[]}const D={};function B(e,t){const u=D[e];if(u)return u;const i=new Promise((r,n)=>{const s=document.createElement("script");t!=null&&t.module?s.type="module":s.type="text/javascript",s.src=e,s.onload=()=>{r(!0)},s.onerror=()=>{n(!1)},(t==null?void 0:t.in)==="head"?document.head.appendChild(s):document.body.appendChild(s);const o=t==null?void 0:t.attributes;o&&Object.keys(o).forEach(a=>{s.setAttribute(a,o[a])})});return D[e]=i,i}function G(e,t){const[u,i]=d.useState("loading");return d.useEffect(()=>{B(e,t).then(()=>i("done")).catch(()=>i("error"))},[e]),u}function $(e){let{type:t,data:u={},customData:i}=e,r=U(),{publish:n,cart:s,prevCart:o,shop:a,customData:l}=Q(),g=r.pathname+r.search,f={...u,customData:{...l,...i},cart:s,prevCart:o,shop:a};return d.useEffect(()=>{a!=null&&a.shopId&&(f={...f,url:window.location.href},n(t,f))},[n,g,a==null?void 0:a.shopId]),null}function z(e){return C.jsx($,{...e,type:"product_viewed"})}function W(e){return C.jsx($,{...e,type:"search_viewed"})}var Z={canTrack:()=>!1,cart:null,customData:{},prevCart:null,publish:()=>{},shop:null,subscribe:()=>{},register:()=>({ready:()=>{}}),customerPrivacy:null,privacyBanner:null},K=d.createContext(Z);function Q(){let e=d.useContext(K);if(!e)throw new Error("[h2:error:useAnalytics] 'useAnalytics()' must be a descendent of <AnalyticsProvider/>");return e}var oe={ProductView:z,SearchView:W},j="cartFormInput";function y({children:e,action:t,inputs:u,route:i,fetcherKey:r}){let n=H({key:r});return C.jsxs(n.Form,{action:i||"",method:"post",children:[(t||u)&&C.jsx("input",{type:"hidden",name:j,value:JSON.stringify({action:t,inputs:u})}),typeof e=="function"?e(n):e]})}y.INPUT_NAME=j;y.ACTIONS={AttributesUpdateInput:"AttributesUpdateInput",BuyerIdentityUpdate:"BuyerIdentityUpdate",Create:"Create",DiscountCodesUpdate:"DiscountCodesUpdate",GiftCardCodesUpdate:"GiftCardCodesUpdate",LinesAdd:"LinesAdd",LinesRemove:"LinesRemove",LinesUpdate:"LinesUpdate",NoteUpdate:"NoteUpdate",SelectedDeliveryOptionsUpdate:"SelectedDeliveryOptionsUpdate",MetafieldsSet:"MetafieldsSet",MetafieldDelete:"MetafieldDelete",DeliveryAddressesAdd:"DeliveryAddressesAdd",DeliveryAddressesUpdate:"DeliveryAddressesUpdate",DeliveryAddressesRemove:"DeliveryAddressesRemove"};function X(e){let t={};for(let s of e.entries()){let o=s[0],a=e.getAll(o);t[o]=a.length>1?a:s[1],t[o]==="on"?t[o]=!0:t[o]==="off"&&(t[o]=!1)}let{cartFormInput:u,...i}=t,{action:r,inputs:n}=u?JSON.parse(String(u)):{};return{action:r,inputs:{...n,...i}}}y.getFormInput=X;var M="__h_pending_";function Y(e){return M+e}function k(e){return e.startsWith(M)}function ie(e){let t=J();if(!t||!t.length)return e;let u=e!=null&&e.lines?structuredClone(e):{lines:{nodes:[]}},i=u.lines.nodes,r=!1;for(let{formData:n}of t){if(!n)continue;let s=y.getFormInput(n);if(s.action===y.ACTIONS.LinesAdd)for(let o of s.inputs.lines){if(!o.selectedVariant){console.error("[h2:error:useOptimisticCart] No selected variant was passed in the cart action. Make sure to pass the selected variant if you want to use an optimistic cart");continue}let a=i.find(l=>{var g;return l.merchandise.id===((g=o.selectedVariant)==null?void 0:g.id)});r=!0,a?(a.quantity=(a.quantity||1)+(o.quantity||1),a.isOptimistic=!0):i.unshift({id:Y(o.selectedVariant.id),merchandise:o.selectedVariant,isOptimistic:!0,quantity:o.quantity||1})}else if(s.action===y.ACTIONS.LinesRemove)for(let o of s.inputs.lineIds){let a=i.findIndex(l=>l.id===o);if(a!==-1){if(k(i[a].id)){console.error("[h2:error:useOptimisticCart] Tried to remove an optimistic line that has not been added to the cart yet");continue}i.splice(a,1),r=!0}else console.warn(`[h2:warn:useOptimisticCart] Tried to remove line '${o}' but it doesn't exist in the cart`)}else if(s.action===y.ACTIONS.LinesUpdate)for(let o of s.inputs.lines){let a=i.findIndex(l=>o.id===l.id);if(a>-1){if(k(i[a].id)){console.error("[h2:error:useOptimisticCart] Tried to update an optimistic line that has not been added to the cart yet");continue}i[a].quantity=o.quantity,i[a].quantity===0&&i.splice(a,1),r=!0}else console.warn(`[h2:warn:useOptimisticCart] Tried to update line '${o.id}' but it doesn't exist in the cart`)}}return r&&(u.isOptimistic=r),u.totalQuantity=i.reduce((n,s)=>n+s.quantity,0),u}var F=d.createContext(void 0);F.Provider;var ee=()=>d.useContext(F),ue=d.forwardRef((e,t)=>{let{waitForHydration:u,src:i,...r}=e,n=ee();return u?C.jsx(te,{src:i,options:r}):C.jsx("script",{suppressHydrationWarning:!0,...r,src:i,nonce:n,ref:t})});function te({src:e,options:t}){if(!e)throw new Error("`waitForHydration` with the Script component requires a `src` prop");return G(e,{attributes:t}),null}function de({connection:e,children:t=()=>(console.warn("<Pagination> requires children to work properly"),null),namespace:u=""}){let[i,r]=d.useState(!1),n=A(),s=U();T(),d.useEffect(()=>{n.state==="idle"&&r(!1)},[n.state]);let{endCursor:o,hasNextPage:a,hasPreviousPage:l,nextPageUrl:g,nodes:f,previousPageUrl:m,startCursor:I}=re(e,u),v=d.useMemo(()=>{var h;return{...s.state,pagination:{...((h=s.state)==null?void 0:h.pagination)||{},[u]:{pageInfo:{endCursor:o,hasPreviousPage:l,hasNextPage:a,startCursor:I},nodes:f}}}},[o,a,l,I,f,u,s.state]),p=d.useMemo(()=>d.forwardRef(function(h,P){return a?d.createElement(q,{preventScrollReset:!0,...h,to:g,state:v,replace:!0,ref:P,onClick:()=>r(!0)}):null}),[a,g,v]),c=d.useMemo(()=>d.forwardRef(function(h,P){return l?d.createElement(q,{preventScrollReset:!0,...h,to:m,state:v,replace:!0,ref:P,onClick:()=>r(!0)}):null}),[l,m,v]);return t({state:v,hasNextPage:a,hasPreviousPage:l,isLoading:i,nextPageUrl:g,nodes:f,previousPageUrl:m,NextLink:p,PreviousLink:c})}function x(e,t){let u=new URLSearchParams(e);return Object.keys((t==null?void 0:t.pagination)||{}).forEach(i=>{let r=i===""?"":`${i}_`,n=`${r}cursor`,s=`${r}direction`;u.delete(n),u.delete(s)}),u.toString()}function w(e){throw new Error(`The Pagination component requires ${"`"+e+"`"} to be a part of your query. See the guide on how to setup your query to include ${"`"+e+"`"}: https://shopify.dev/docs/custom-storefronts/hydrogen/data-fetching/pagination#setup-the-paginated-query`)}function re(e,t=""){e.pageInfo||w("pageInfo"),typeof e.pageInfo.startCursor>"u"&&w("pageInfo.startCursor"),typeof e.pageInfo.endCursor>"u"&&w("pageInfo.endCursor"),typeof e.pageInfo.hasNextPage>"u"&&w("pageInfo.hasNextPage"),typeof e.pageInfo.hasPreviousPage>"u"&&w("pageInfo.hasPreviousPage");let u=A(),i=T(),{state:r,search:n,pathname:s}=U(),o=t?`${t}_cursor`:"cursor",a=t?`${t}_direction`:"direction",l=new URLSearchParams(n).get(a)==="previous",g=d.useMemo(()=>{var p,c,h;return!((p=globalThis==null?void 0:globalThis.window)!=null&&p.__hydrogenHydrated)||!((h=(c=r==null?void 0:r.pagination)==null?void 0:c[t])!=null&&h.nodes)?S(e):l?[...S(e),...r.pagination[t].nodes||[]]:[...r.pagination[t].nodes||[],...S(e)]},[r,e,t]),f=d.useMemo(()=>{var O,_,L,b,R;let p=(O=globalThis==null?void 0:globalThis.window)==null?void 0:O.__hydrogenHydrated,c=(L=(_=r==null?void 0:r.pagination)==null?void 0:_[t])==null?void 0:L.pageInfo,h=!p||(c==null?void 0:c.startCursor)===void 0?e.pageInfo.startCursor:c.startCursor,P=!p||(c==null?void 0:c.endCursor)===void 0?e.pageInfo.endCursor:c.endCursor,E=!p||(c==null?void 0:c.hasPreviousPage)===void 0?e.pageInfo.hasPreviousPage:c.hasPreviousPage,N=!p||(c==null?void 0:c.hasNextPage)===void 0?e.pageInfo.hasNextPage:c.hasNextPage;return(R=(b=r==null?void 0:r.pagination)==null?void 0:b[t])!=null&&R.nodes&&(l?(h=e.pageInfo.startCursor,E=e.pageInfo.hasPreviousPage):(P=e.pageInfo.endCursor,N=e.pageInfo.hasNextPage)),{startCursor:h,endCursor:P,hasPreviousPage:E,hasNextPage:N}},[l,r,t,e.pageInfo.hasNextPage,e.pageInfo.hasPreviousPage,e.pageInfo.startCursor,e.pageInfo.endCursor]),m=d.useRef({params:x(n,r),pathname:s});d.useEffect(()=>{window.__hydrogenHydrated=!0},[]),d.useEffect(()=>{let p=x(n,r),c=m.current.params;(s!==m.current.pathname||p!==c)&&!(u.state==="idle"&&!u.location)&&(m.current={pathname:s,params:x(n,r)},i(`${s}?${x(n,r)}`,{replace:!0,preventScrollReset:!0,state:{nodes:void 0,pageInfo:void 0}}))},[s,n,r]);let I=d.useMemo(()=>{let p=new URLSearchParams(n);return p.set(a,"previous"),f.startCursor&&p.set(o,f.startCursor),`?${p.toString()}`},[n,f.startCursor]),v=d.useMemo(()=>{let p=new URLSearchParams(n);return p.set(a,"next"),f.endCursor&&p.set(o,f.endCursor),`?${p.toString()}`},[n,f.endCursor]);return{...f,previousPageUrl:I,nextPageUrl:v,nodes:g}}function ce(e,t){let u=A(),[i,r]=d.useState([]);if(d.useEffect(()=>{Promise.resolve(t).then(n=>{var s,o;n&&r(n instanceof Array?n:((o=(s=n.product)==null?void 0:s.variants)==null?void 0:o.nodes)||[])}).catch(n=>{reportError(new Error("[h2:error:useOptimisticVariant] An error occurred while resolving the variants for the optimistic product hook.",{cause:n}))})},[JSON.stringify(t)]),u.state==="loading"){let n=new URLSearchParams(u.location.search),s=!1,o=i.find(a=>a.selectedOptions?a.selectedOptions.every(l=>n.get(l.name)===l.value):(s||(s=!0,reportError(new Error("[h2:error:useOptimisticVariant] The optimistic product hook requires your product query to include variants with the selectedOptions field."))),!1));if(o)return{...o,isOptimistic:!0}}return e}d.lazy(()=>V(()=>import("./log-seo-tags-TY72EQWZ-DCHH-_Gl.js"),[]));export{ee as $,ue as I,ie as J,y as j,de as k,ce as q,oe as s};
